<html>

<body onload="canvas.setup()">
    <body style="background-color:rgb(0, 0, 0);"></body>
    <canvas id="canvasArea1" style="position: absolute; left: 0; top: 0; z-index: 0; width:100%;height:100%"></canvas>
    <canvas id="canvasArea2"
        style="visibility: hidden; position: absolute; left: 0; top: 0; z-index: 0; width:100%;height:100%"></canvas>

    <script src="./canvas.js"></script>
</body>

</html>
<script>
    //declare global variables here
    var menu;
    var instruct;
    var game;
    var boss;
    var end;
    menuCircleArray = [];
    var x;
    var y;
    var vx;
    var vy;
    var radius;
    var col;
    var colorArray;
    function setup() {
        // Initialize variables here
        menu = 1;
        instruct = 0;
        game = 0;
        boss = 0;
        end = 0;
        colorArray=["#ffaa33","#99ffaa","#00ff00","#4411aa","#ff1100"];
        for(var i = 0; i < 200; i++) 
        { 
            radius=Math.random()*7+3;
            y= Math.random()*(canvas.height - radius*2) + radius;
            x= Math.random()*(canvas.width - radius*2) + radius;
            vx=(Math.random()-0.5)*1;
            vy=(Math.random()-0.5)*1;
            menuCircleArray.push(new MenuCircle(x,y,radius,vx,vy,colorArray[Math.floor(Math.random()*colorArray.length)]));
        }
    }

    class Player
    {
        constructor(x,y,radius,col)
        {
            this.x=x;
            this.y=y;
            this.radius=radius;
            this.col=col;
        }
        draw= function()
        {
            canvas.setDrawMode("fill");
            canvas.setColor(this.col);
            canvas.drawCircle(this.x, this.y, this.radius);
        }
        update= function()
        {
            this.x = canvas.mouseX;
            this.draw();
        }
    }
    player1=new Player(100,window.innerHeight,40,"rgb(255,255,0)");
    class Pellets
    {
        constructor(x,y,vy,radius,col)
        {
            this.x=x;
            this.y=y;
            this.vy=vy;
            this.radius=radius;
            this.col=col;
            this.xt=x;
        }
        draw = function()
        {
            canvas.setDrawMode("fill");
            canvas.setColor(this.col);
            canvas.drawCircle(this.x, this.y, this.radius);
        }
        update=function()
        {
            this.y += this.vy;
            this.draw();
        }
    }
    
    class MenuCircle
    {
        constructor(x,y,radius,vx,vy,col,initrad)
        {
            this.x=x;
            this.y=y;
            this.vx=vx;
            this.vy=vy;
            this.radius=radius;
            this.col=col;
            this.initrad=radius;
        }
        
        update=function()
        {
            if (this.x+this.radius>canvas.width || this.x-this.radius<0)
            {
                this.vx=-this.vx;
            }   
            if (this.y+this.radius>canvas.height || this.y-this.radius<0)
            {
                this.vy=-this.vy;
            }
            this.x+=this.vx;
            this.y+=this.vy;
           
            if(canvas.mouseX-this.x<50 && this.x-canvas.mouseX<50 && canvas.mouseY-this.y<50 && this.y-canvas.mouseY<50 && this.radius<=50)
            {
                this.radius+=1;
            }
            else if(this.radius>=this.initrad)
            {
                this.radius-=0.2;
            }
            canvas.setDrawMode("fill");
            canvas.setColor(this.col);
            canvas.drawCircle(this.x, this.y, this.radius);
            
        }
    }
    
    /*class GameEnemy 
    {
        constructor(x,y,dx,dy,acc,radius,color) 
        {
            this.x = x;
            this.y = y;
            this.vx = vx;
            this.vy = vy;
            this.acc = acc;
            this.radius = radius;
            this.color = color;
        }

        draw = function() {
            c.beginPath();
            c.arc(this.x,this.y,this.radius,0,Math.PI*2,false);
            c.fillStyle=this.color;
            c.fill();
        }

        update = function()
        {
            if(this.y+this.radius >= window.innerHeight) 
            {
                this.vy = -this.vy;
            }
            else
            {
                this.vy += this.acc;
            }
            this.y += this.vy;
            this.draw();
        }


    }
    */
   
    /*class shatterCircles
    {
        constructor(x, y, vx, vy, acc, radius, color, hop, e) 
        {
            this.x = x;
            this.y = y;
            this.vx = vx;
            this.vy = vy;
            this.acc = acc;
            this.radius = radius;
            this.color = color;
            this.hop = hop;
            this.e = e;
        }
        draw = function() 
        {
            inctheta+=0.1;
            c.beginPath();
            c.arc(this.x,this.y,this.radius,0,Math.PI*2,false);
            c.fillStyle=this.color;
            c.fill();
        }
        bossdraw = function() 
        {
            inctheta+=0.05;
            c.beginPath();
            c.arc(this.x+40*Math.cos(inctheta),this.y+40*Math.sin(inctheta),this.radius,0,Math.PI*2,false);
            c.fillStyle=this.color;
            c.fill();
        }

        update = function() 
        {   
            if(this.y+this.radius >= window.innerHeight) 
            {
                this.vy = -this.vy * this.e;
            }
            else
            {
                this.vy += this.acc;
            }
            this.y += this.vy;
            this.x += this.vx;
            c.globalAlpha=1;
            this.draw();
        }

        bossUpdate = function()
        {
            if(this.x+this.radius >= canvas.width || this.x - this.radius <= 0) 
            {
                this.vx = -this.vx;
            }
            else
            {
                this.vy += this.acc;
            }
            this.y += this.vy;
            this.x += this.vx;
            c.globalAlpha=1;
            this.bossdraw()
        }
    }
    */
    
    /*class endCircles 
    {
        constructor(r,theta,radius,acc_theta,vel_theta,acc_r,color)
        {
            this.r = r;
            this.theta = theta;
            this.radius = radius;
            this.acc_theta = acc_theta;
            this.acc_r = acc_r;
            this.color = color;
            this.finalX=mwhere.x+this.r*Math.cos(this.theta);
            this.finalY=mwhere.y+this.r*Math.sin(this.theta);
            this.vel_theta=vel_theta;
            this.ogR = r;
            this.ogVelTheta = vel_theta;
        }

        draw = function() 
        {
            c.beginPath();
            c.arc(this.finalX,this.finalY,this.radius,0,Math.PI*2,false);
            c.fillStyle=this.color;
            c.fill();
        }

        update = function()
        {
            this.theta+=this.vel_theta;
            this.finalX=mwhere.x+this.r*Math.cos(this.theta);
            this.finalY=mwhere.y+this.r*Math.sin(this.theta);
            if(end_acc == 1) 
            {
                this.vel_theta += this.acc_theta;
                this.r += this.acc_r;
            }
            else
            {
                if(this.vel_theta > this.ogVelTheta) 
                {
                    this.vel_theta -= this.acc_theta/2;
                }
                if(this.r > this.ogR)
                {
                    this.r -= this.acc_r/2;
                }
            }
            this.draw();
        }
    }
    */

    // Function while will be called repeatedly 
    function main() {
        canvas.clear();
        if(menu == 1) {
            for(var i = 0; i < menuCircleArray.length; i++)
            {
            menuCircleArray[i].update();
            }
            canvas.setColor("#FFFFFF");
            canvas.drawText(Math.floor(window.innerWidth/2 - 70), Math.floor(window.innerHeight/2),"Press S to begin", fontSize = 30);
            if(canvas.isKeyDown("KeyS")){
                console.log("S was pressed");
                menu = 0;
                instruct = 1;
            }
        }
        
        else if(instruct == 1) {
            if(canvas.isKeyDown("KeyG")){
                console.log("G was pressed");
                instruct = 0;
                game = 1;
            }
        }
        else if(game == 1){
            player1.update();
        }
    }

    // Override functions here; 
    canvas.mainFunction = main;

    var timeStep = 30;
    canvas.startMain(timeStep);
    canvas.setupFunction = setup;

</script>